<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Zou Yi&#39;s Blog</title>
  
  <subtitle>纵使困顿难行 亦当砥砺奋进</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://eyum.top/"/>
  <updated>2020-07-08T15:11:05.257Z</updated>
  <id>https://eyum.top/</id>
  
  <author>
    <name>邹毅</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>去除kindle电子书DRM锁</title>
    <link href="https://eyum.top/2020/04/23/%E5%8E%BB%E9%99%A4kindle%E7%94%B5%E5%AD%90%E4%B9%A6DRM%E9%94%81/"/>
    <id>https://eyum.top/2020/04/23/去除kindle电子书DRM锁/</id>
    <published>2020-04-23T14:29:00.000Z</published>
    <updated>2020-07-08T15:11:05.257Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>针对自己购买的书籍，请支持正版！</p></blockquote><p>有空写</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;针对自己购买的书籍，请支持正版！&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;有空写&lt;/p&gt;

      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>pytorch 自定义Dataset</title>
    <link href="https://eyum.top/2020/04/08/pytorch-%E8%87%AA%E5%AE%9A%E4%B9%89Dataset/"/>
    <id>https://eyum.top/2020/04/08/pytorch-自定义Dataset/</id>
    <published>2020-04-08T11:44:29.000Z</published>
    <updated>2020-07-08T14:57:42.024Z</updated>
    
    <content type="html"><![CDATA[<p>有空写</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;有空写&lt;/p&gt;

      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>TensorFlow自定义优化器</title>
    <link href="https://eyum.top/2020/04/05/TensorFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BC%98%E5%8C%96%E5%99%A8/"/>
    <id>https://eyum.top/2020/04/05/TensorFlow自定义优化器/</id>
    <published>2020-04-05T00:55:59.000Z</published>
    <updated>2020-07-08T14:57:19.994Z</updated>
    
    <content type="html"><![CDATA[<p>有空写</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;有空写&lt;/p&gt;

      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Tensorflow Optimizer 梯度修正</title>
    <link href="https://eyum.top/2020/04/03/Tensorflow-Optimizer-%E6%A2%AF%E5%BA%A6%E4%BF%AE%E6%AD%A3/"/>
    <id>https://eyum.top/2020/04/03/Tensorflow-Optimizer-梯度修正/</id>
    <published>2020-04-03T12:18:20.000Z</published>
    <updated>2020-07-08T14:57:00.740Z</updated>
    
    <content type="html"><![CDATA[<p>有空写</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;有空写&lt;/p&gt;

      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Tensorflow 优化器详解</title>
    <link href="https://eyum.top/2020/03/28/Tensorflow-%E4%BC%98%E5%8C%96%E5%99%A8%E8%AF%A6%E8%A7%A3/"/>
    <id>https://eyum.top/2020/03/28/Tensorflow-优化器详解/</id>
    <published>2020-03-28T09:50:42.000Z</published>
    <updated>2020-07-08T14:57:10.364Z</updated>
    
    <content type="html"><![CDATA[<p>有空写</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;有空写&lt;/p&gt;

      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Precision、Recall</title>
    <link href="https://eyum.top/2020/03/26/Precision%E3%80%81Recall/"/>
    <id>https://eyum.top/2020/03/26/Precision、Recall/</id>
    <published>2020-03-26T02:33:00.000Z</published>
    <updated>2020-07-08T14:57:32.522Z</updated>
    
    <content type="html"><![CDATA[<p>有空写</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;有空写&lt;/p&gt;

      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>ChromeOS 提升JetBrains系列流畅度</title>
    <link href="https://eyum.top/2020/03/08/ChromeOS-%E6%8F%90%E5%8D%87JetBrains%E7%B3%BB%E5%88%97%E6%B5%81%E7%95%85%E5%BA%A6/"/>
    <id>https://eyum.top/2020/03/08/ChromeOS-提升JetBrains系列流畅度/</id>
    <published>2020-03-08T11:55:27.000Z</published>
    <updated>2020-07-08T14:56:46.509Z</updated>
    
    <content type="html"><![CDATA[<p>有空写</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;有空写&lt;/p&gt;

      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Django 跨域问题</title>
    <link href="https://eyum.top/2020/03/03/Django-%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/"/>
    <id>https://eyum.top/2020/03/03/Django-跨域问题/</id>
    <published>2020-03-03T08:59:11.000Z</published>
    <updated>2020-07-08T14:47:11.603Z</updated>
    
    <content type="html"><![CDATA[<h3 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h3><p>Django 项目，在 html 页面中使用了 frameset 以及 frame 标签。</p><h3 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h3><p>运行结果：</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="frame.png" alt title>                </div>                <div class="image-caption"></div>            </figure><p>f12 调试，看到一下报错。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Refused to display &apos;http://127.0.0.1:8000/top.html&apos; in a frame because it set &apos;X-Frame-Options&apos; to &apos;deny&apos;.</span><br><span class="line">Refused to display &apos;http://127.0.0.1:8000/left.html&apos; in a frame because it set &apos;X-Frame-Options&apos; to &apos;deny&apos;.</span><br><span class="line">Refused to display &apos;http://127.0.0.1:8000/news.html&apos; in a frame because it set &apos;X-Frame-Options&apos; to &apos;deny&apos;.</span><br></pre></td></tr></table></figure><h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><p>主要是 Django 将页面通过iframe显示在 app 页面中。而在这个页面中 request header 中多出响应头 X-Frame-Options 值默认为 deny，于是报出如下错误。</p><h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><h4 id="针对每个-view-设置"><a href="#针对每个-view-设置" class="headerlink" title="针对每个 view 设置"></a>针对每个 view 设置</h4><p>可以设置 view 响应头为 exempt，一共有以下三种：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@xframe_options_deny          #不允许在frame中展示</span><br><span class="line">@xframe_options_sameorigin    #允许在通域名的frame中展示</span><br><span class="line">@xframe_options_exempt        #去掉iframe限制，允许iframe访问某一个views</span><br></pre></td></tr></table></figure><p>那么，在 views.py 中对某个 view 指定即可：</p><figure class="highlight python"><figcaption><span>views.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@xframe_options_exempt</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">top</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'NetEase/top.html'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@xframe_options_exempt</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">left</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'NetEase/left.html'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@xframe_options_exempt</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">news</span><span class="params">(request)</span>:</span></span><br><span class="line">    limit = <span class="number">4</span>  <span class="comment"># 限制每一页显示的条目数量</span></span><br><span class="line">    article = NetEase.objects</span><br><span class="line">    paginator = Paginator(article, limit)</span><br><span class="line">    page_num = request.GET.get(<span class="string">'page'</span>, <span class="number">1</span>)  <span class="comment"># 从url中获取页码参数</span></span><br><span class="line">    page_num = int(page_num)  <span class="comment"># 把当前的页码数转换为整数类型</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        loaded = paginator.page(page_num)  <span class="comment"># 获取当前页码的记录</span></span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        loaded = paginator.page(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> PageNotAnInteger:</span><br><span class="line">        loaded = paginator.page(<span class="number">1</span>)  <span class="comment"># 如果用户输入的页码不是整数时,显示第1页的内容</span></span><br><span class="line">    <span class="keyword">except</span> EmptyPage:</span><br><span class="line">        loaded = paginator.page(paginator.num_pages)  <span class="comment"># 如果用户输入的页码超出总页码时,显示第1页的内容</span></span><br><span class="line">    context = &#123;</span><br><span class="line">        <span class="string">'NetEase'</span>: loaded</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'NetEase/news.html'</span>, context)</span><br></pre></td></tr></table></figure><p>效果：</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="frame1.png" alt title>                </div>                <div class="image-caption"></div>            </figure><h4 id="针对全部页面"><a href="#针对全部页面" class="headerlink" title="针对全部页面"></a>针对全部页面</h4><p>在 settings 中设置即可。</p><figure class="highlight python"><figcaption><span>settings.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X_FRAME_OPTIONS = <span class="string">'ALLOWALL url'</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;起因&quot;&gt;&lt;a href=&quot;#起因&quot; class=&quot;headerlink&quot; title=&quot;起因&quot;&gt;&lt;/a&gt;起因&lt;/h3&gt;&lt;p&gt;Django 项目，在 html 页面中使用了 frameset 以及 frame 标签。&lt;/p&gt;
&lt;h3 id=&quot;报错&quot;&gt;&lt;a href=
      
    
    </summary>
    
    
      <category term="Software" scheme="https://eyum.top/categories/Software/"/>
    
    
      <category term="Django" scheme="https://eyum.top/tags/Django/"/>
    
  </entry>
  
  <entry>
    <title>Django POST 403 Forbidden</title>
    <link href="https://eyum.top/2020/03/03/Django-POST-403-Forbidden/"/>
    <id>https://eyum.top/2020/03/03/Django-POST-403-Forbidden/</id>
    <published>2020-03-03T08:58:31.000Z</published>
    <updated>2020-07-14T11:26:48.838Z</updated>
    
    <content type="html"><![CDATA[<h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><p>我这边定义了一个表单，向后台提交数据，提交方式为 <code>POST</code>，程序出现以下问题：</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="post.png" alt title>                </div>                <div class="image-caption"></div>            </figure><h3 id="出现原因"><a href="#出现原因" class="headerlink" title="出现原因"></a>出现原因</h3><p>出现这个报错的原因主要是跨站请求伪造。Django 框架为我们提供了一个中间件，用于处理跨站请求伪造，假如某个用户从来没有登录过我们的网站就给我们网站 post 数据，这样是会被 Django 这个中间件给阻挡，禁止请求。然后我们在开发 web 的时候可以给每一个登录的用户分配一个 token。这个 token 会被写入到用户的 cookie 文件里面。然后下次用户 post 数据的时候，就会带上这个 token。 因此如果没有 token 的用户就会被禁止 post 数据。</p><h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><h4 id="改-settings-文件"><a href="#改-settings-文件" class="headerlink" title="改 settings 文件"></a>改 settings 文件</h4><p>注释掉 settings 文件里关于 CSRF 的验证。</p><figure class="highlight python"><figcaption><span>settings.py </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MIDDLEWARE = [</span><br><span class="line">    <span class="string">'django.middleware.security.SecurityMiddleware'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions.middleware.SessionMiddleware'</span>,</span><br><span class="line">    <span class="string">'django.middleware.common.CommonMiddleware'</span>,</span><br><span class="line">    <span class="comment"># 'django.middleware.csrf.CsrfViewMiddleware',  # POST 403</span></span><br><span class="line">    <span class="string">'django.contrib.auth.middleware.AuthenticationMiddleware'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages.middleware.MessageMiddleware'</span>,</span><br><span class="line">    <span class="string">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h4 id="改-views-文件"><a href="#改-views-文件" class="headerlink" title="改 views 文件"></a>改 views 文件</h4><p>或者可以在你的 views 文件内，导入模块 <code>from django.views.decorators.csrf import csrf_exempt</code>，并在接收 POST 请求数据的函数前面添加修饰器 <code>@csrf_exempt</code>。</p><p>以上两个方法都可以让当前的 POST 不受 Django 跨站请求伪造的中间件的限制。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;原因&quot;&gt;&lt;a href=&quot;#原因&quot; class=&quot;headerlink&quot; title=&quot;原因&quot;&gt;&lt;/a&gt;原因&lt;/h3&gt;&lt;p&gt;我这边定义了一个表单，向后台提交数据，提交方式为 &lt;code&gt;POST&lt;/code&gt;，程序出现以下问题：&lt;/p&gt;
&lt;figure class
      
    
    </summary>
    
    
      <category term="Software" scheme="https://eyum.top/categories/Software/"/>
    
    
      <category term="Django" scheme="https://eyum.top/tags/Django/"/>
    
  </entry>
  
  <entry>
    <title>MongoEngine读取数据库</title>
    <link href="https://eyum.top/2020/02/28/MongoEngine%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    <id>https://eyum.top/2020/02/28/MongoEngine读取数据库/</id>
    <published>2020-02-28T07:06:33.000Z</published>
    <updated>2020-07-08T09:00:50.876Z</updated>
    
    <content type="html"><![CDATA[<h3 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h3><p>将 MongoDB 数据库内的数据读取出来，并展示在前端页面。</p><h3 id="在-settings-中建立连接"><a href="#在-settings-中建立连接" class="headerlink" title="在 settings 中建立连接"></a>在 settings 中建立连接</h3><p>连结信息写在 settings.py 中，同时注释原有的 sqlite 数据库连接。</p><figure class="highlight python"><figcaption><span>setting.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指明要连接的数据库</span></span><br><span class="line">mongo_con = mongoengine.connect(<span class="string">'***'</span>, host=<span class="string">'your ip address'</span>, port=<span class="number">27017</span>, username=<span class="string">"***"</span>, password=<span class="string">"***"</span>)</span><br><span class="line">collection = str(datetime.date.today())</span><br><span class="line">mongo_db = mongo_con[collection]</span><br><span class="line"></span><br><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">'default'</span>: &#123;</span><br><span class="line">        <span class="comment"># 'ENGINE': 'django.db.backends.sqlite3',</span></span><br><span class="line">        <span class="comment"># 'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;  <span class="comment"># 注释掉默认数据库连接</span></span><br></pre></td></tr></table></figure><h3 id="在-models-中声明需要查询的集合以及字段"><a href="#在-models-中声明需要查询的集合以及字段" class="headerlink" title="在 models 中声明需要查询的集合以及字段"></a>在 models 中声明需要查询的集合以及字段</h3><p>声明需要查询的字段，与你的数据库表结构对应。</p><figure class="highlight python"><figcaption><span>models.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> mongoengine <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">connect(<span class="string">'163news'</span>, host=<span class="string">'117.78.0.242'</span>, port=<span class="number">27017</span>, username=<span class="string">"zouyi"</span>, password=<span class="string">"980718"</span>)  <span class="comment"># 指明要连接的数据库</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NetEase</span><span class="params">(Document)</span>:</span></span><br><span class="line">    _id = ObjectIdField(required=<span class="literal">True</span>)</span><br><span class="line">    url = StringField(required=<span class="literal">True</span>)</span><br><span class="line">    title = StringField(required=<span class="literal">True</span>)</span><br><span class="line">    date = StringField(required=<span class="literal">True</span>)</span><br><span class="line">    content = StringField(required=<span class="literal">True</span>)</span><br><span class="line">    abstract = StringField(required=<span class="literal">True</span>)</span><br><span class="line">    id = IntField(required=<span class="literal">True</span>)</span><br><span class="line">    comments = StringField(required=<span class="literal">True</span>)</span><br><span class="line">    heat = IntField(required=<span class="literal">True</span>)</span><br><span class="line">    collection = str(datetime.date.today())</span><br><span class="line">    meta = &#123;<span class="string">'collection'</span>: collection&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in NetEase.objects[:20]:  # 测试是否连接成功</span></span><br><span class="line"><span class="comment">#     print(str(i.id) + ": " + i.content[:20])</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="在-views-内获取相应的信息"><a href="#在-views-内获取相应的信息" class="headerlink" title="在 views 内获取相应的信息"></a>在 views 内获取相应的信息</h3><p>同时在 views.py 中获取所需信息，并使用 paginator 分页，通过 render 传给html。</p><blockquote><p>分页可查看 <a href="/2020/02/28/Django使用分页器/" title="Django使用分页器">Django使用分页器</a></p></blockquote><figure class="highlight python"><figcaption><span>views.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.core.paginator <span class="keyword">import</span> Paginator, PageNotAnInteger, EmptyPage</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">from</span> django.views.decorators.clickjacking <span class="keyword">import</span> xframe_options_exempt</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> NetEase.models <span class="keyword">import</span> NetEase</span><br><span class="line"></span><br><span class="line"><span class="meta">@xframe_options_exempt</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">news</span><span class="params">(request)</span>:</span></span><br><span class="line">    limit = <span class="number">4</span>  <span class="comment"># 限制每一页显示的条目数量</span></span><br><span class="line">    article = NetEase.objects</span><br><span class="line">    paginator = Paginator(article, limit)</span><br><span class="line">    page_num = request.GET.get(<span class="string">'page'</span>, <span class="number">1</span>)  <span class="comment"># 从url中获取页码参数</span></span><br><span class="line">    page_num = int(page_num)  <span class="comment"># 把当前的页码数转换为整数类型</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        loaded = paginator.page(page_num)  <span class="comment"># 获取当前页码的记录</span></span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        loaded = paginator.page(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> PageNotAnInteger:</span><br><span class="line">        loaded = paginator.page(<span class="number">1</span>)  <span class="comment"># 如果用户输入的页码不是整数时,显示第1页的内容</span></span><br><span class="line">    <span class="keyword">except</span> EmptyPage:</span><br><span class="line">        loaded = paginator.page(paginator.num_pages)  <span class="comment"># 如果用户输入的页码超出总页码时,显示第1页的内容</span></span><br><span class="line">    context = &#123;</span><br><span class="line">        <span class="string">'NetEase'</span>: loaded</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'NetEase/news.html'</span>, context)</span><br></pre></td></tr></table></figure><h3 id="对应信息展示在前端"><a href="#对应信息展示在前端" class="headerlink" title="对应信息展示在前端"></a>对应信息展示在前端</h3><p>遍历查询到的数据，通过 <code>item.xxx</code> 加载到 html。</p><figure class="highlight html"><figcaption><span>news.html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for item in NetEase %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"news1"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></span><br><span class="line">                    &#123;#                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"red"</span>&gt;</span>全国<span class="tag">&lt;/<span class="name">span</span>&gt;</span>#&#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; item.title &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;% static 'img/new.gif' %&#125;"</span> <span class="attr">alt</span>=<span class="string">"new"</span>/&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"ls"</span>&gt;</span>[正/负面信息]<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"h3bottom1"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"feb900"</span>&gt;</span>&#123;&#123; item.date &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                &#123;% if item.content|length &gt;= 300 %&#125;</span><br><span class="line">                    &#123;&#123; item.content|slice:"300" &#125;&#125; ……</span><br><span class="line">                    &#123;% else %&#125;&#123;&#123; item.content &#125;&#125;</span><br><span class="line">                &#123;% endif %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"font-weight: bold;text-decoration: underline;"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; item.url &#125;&#125;"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>阅读原文<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"butt"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;% static 'img/xxlist_03_15.png' %&#125;"</span> <span class="attr">alt</span>=<span class="string">""</span>/&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;% static 'img/xxlist_03_13.png' %&#125;"</span> <span class="attr">alt</span>=<span class="string">""</span>/&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;% static 'img/xxlist_03_11.png' %&#125;"</span> <span class="attr">alt</span>=<span class="string">""</span>/&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;% static 'img/xxlist_03_09.png' %&#125;"</span> <span class="attr">alt</span>=<span class="string">""</span>/&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;% static 'img/xxlist_03_07.png' %&#125;"</span> <span class="attr">alt</span>=<span class="string">""</span>/&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"clear"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><p>完整效果：</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="舆情系统.png" alt title>                </div>                <div class="image-caption"></div>            </figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;需求分析&quot;&gt;&lt;a href=&quot;#需求分析&quot; class=&quot;headerlink&quot; title=&quot;需求分析&quot;&gt;&lt;/a&gt;需求分析&lt;/h3&gt;&lt;p&gt;将 MongoDB 数据库内的数据读取出来，并展示在前端页面。&lt;/p&gt;
&lt;h3 id=&quot;在-settings-中建立连接&quot;&gt;
      
    
    </summary>
    
    
      <category term="Software" scheme="https://eyum.top/categories/Software/"/>
    
    
      <category term="Django" scheme="https://eyum.top/tags/Django/"/>
    
      <category term="MongoDB" scheme="https://eyum.top/tags/MongoDB/"/>
    
  </entry>
  
  <entry>
    <title>Django使用分页器</title>
    <link href="https://eyum.top/2020/02/28/Django%E4%BD%BF%E7%94%A8%E5%88%86%E9%A1%B5%E5%99%A8/"/>
    <id>https://eyum.top/2020/02/28/Django使用分页器/</id>
    <published>2020-02-28T07:03:31.000Z</published>
    <updated>2020-07-08T09:48:54.974Z</updated>
    
    <content type="html"><![CDATA[<h3 id="使用默认的分页器"><a href="#使用默认的分页器" class="headerlink" title="使用默认的分页器"></a>使用默认的分页器</h3><p>数据库内存的数据较多，读取的时候一页太长，因此需要使用分页器进行分页，在 Django 的 views 内声明。</p><figure class="highlight python"><figcaption><span>views.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.core.paginator <span class="keyword">import</span> Paginator, PageNotAnInteger, EmptyPage</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">from</span> django.views.decorators.clickjacking <span class="keyword">import</span> xframe_options_exempt</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> NetEase.models <span class="keyword">import</span> NetEase</span><br><span class="line"></span><br><span class="line"><span class="meta">@xframe_options_exempt</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">news</span><span class="params">(request)</span>:</span></span><br><span class="line">    limit = <span class="number">4</span>  <span class="comment"># 限制每一页显示的条目数量</span></span><br><span class="line">    article = NetEase.objects</span><br><span class="line">    paginator = Paginator(article, limit)</span><br><span class="line">    page_num = request.GET.get(<span class="string">'page'</span>, <span class="number">1</span>)  <span class="comment"># 从url中获取页码参数</span></span><br><span class="line">    page_num = int(page_num)  <span class="comment"># 把当前的页码数转换为整数类型</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        loaded = paginator.page(page_num)  <span class="comment"># 获取当前页码的记录</span></span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        loaded = paginator.page(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> PageNotAnInteger:</span><br><span class="line">        loaded = paginator.page(<span class="number">1</span>)  <span class="comment"># 如果用户输入的页码不是整数时,显示第1页的内容</span></span><br><span class="line">    <span class="keyword">except</span> EmptyPage:</span><br><span class="line">        loaded = paginator.page(paginator.num_pages)  <span class="comment"># 如果用户输入的页码超出总页码时,显示第1页的内容</span></span><br><span class="line">    context = &#123;</span><br><span class="line">        <span class="string">'NetEase'</span>: loaded</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'NetEase/news.html'</span>, context)</span><br></pre></td></tr></table></figure><p>这样，在 URL 上就可以通过 <code>?page=x</code> 来访问第 x 页的数据，例如：<code>http://127.0.0.1:8000/news.html?page=6</code> 展示的就是第六页的数据。</p><h3 id="上下页及跳转"><a href="#上下页及跳转" class="headerlink" title="上下页及跳转"></a>上下页及跳转</h3><p>为了方便，在前端上做一个上下页以及跳转的按钮。</p><figure class="highlight html"><figcaption><span>news.html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"fy"</span>&gt;</span></span><br><span class="line">        &#123;% if NetEase.has_previous %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?page=&#123;&#123; NetEase.previous_page_number &#125;&#125;"</span>&gt;</span> 上一页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123; NetEase.number &#125;&#125; of &#123;&#123; NetEase.paginator.num_pages &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &#123;% if NetEase.has_next %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?page=&#123;&#123; NetEase.next_page_number &#125;&#125;"</span>&gt;</span>下一页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tiaozhao"</span>&gt;</span></span><br><span class="line">            &#123;#            <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"?page=&#123;&#123; page &#125;&#125;"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span>#&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"wb"</span> <span class="attr">id</span>=<span class="string">"page"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"tj"</span> <span class="attr">value</span>=<span class="string">"跳转"</span> <span class="attr">onclick</span>=<span class="string">"tz()"</span>/&gt;</span></span><br><span class="line">            &#123;#            <span class="tag">&lt;/<span class="name">form</span>&gt;</span>#&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"clear"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"&#123;% static 'js/nav.js' %&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">tz</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="vbscript">        &#123;#alert(<span class="string">"?page="</span> + document.getElementById(<span class="string">"page"</span>).value);#&#125;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.location.href = <span class="string">"?page="</span> + <span class="built_in">document</span>.getElementById(<span class="string">"page"</span>).value;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>最终效果：</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="Bar.png" alt="Bar.png" title>                </div>                <div class="image-caption">Bar.png</div>            </figure><p>异常输入也没问题，会跳转到第一页，代码在 views 内。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;使用默认的分页器&quot;&gt;&lt;a href=&quot;#使用默认的分页器&quot; class=&quot;headerlink&quot; title=&quot;使用默认的分页器&quot;&gt;&lt;/a&gt;使用默认的分页器&lt;/h3&gt;&lt;p&gt;数据库内存的数据较多，读取的时候一页太长，因此需要使用分页器进行分页，在 Django 的 
      
    
    </summary>
    
    
      <category term="Software" scheme="https://eyum.top/categories/Software/"/>
    
    
      <category term="Django" scheme="https://eyum.top/tags/Django/"/>
    
  </entry>
  
  <entry>
    <title>MongoDB强制密码登录</title>
    <link href="https://eyum.top/2020/02/26/MongoDB%E5%BC%BA%E5%88%B6%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95/"/>
    <id>https://eyum.top/2020/02/26/MongoDB强制密码登录/</id>
    <published>2020-02-26T12:23:45.000Z</published>
    <updated>2020-07-08T09:47:30.504Z</updated>
    
    <content type="html"><![CDATA[<h3 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h3><p>今天一看突然发现网站上的数据都没了，一看数据库，里面的表全没了，然后多了一张叫 <code>RECOVERY</code> 的 <code>Collections</code>，还贴心的留下了个Email：<a href="mailto:varsovie@tutanota.com" target="_blank" rel="noopener">varsovie@tutanota.com</a> 来寻求帮助，真好。 =͟͟͞͞=͟͟͞͞(●⁰ꈊ⁰● |||)</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="shell.png" alt="shell" title>                </div>                <div class="image-caption">shell</div>            </figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="navicat.png" alt="navicat" title>                </div>                <div class="image-caption">navicat</div>            </figure><p>搜了一下这个邮箱，还真有不少，找了一篇相似的：<a href="https://juejin.im/post/5dd2c632e51d453fe773f0b4" target="_blank" rel="noopener">【掘金】</a><br>原因是MongoDB默认直接连接，无须身份认证，而对方很可能仅仅是尝试各个IP的27017端口<br>还好我数据库内没什么非常重要的文件，不过这次也给我提了个醒</p><ul><li>尽量不要用默认端口（MongoDB为27017）</li><li>必要的话限制IP登录（<code>/etc/mongod.conf</code> 文件内 <code>bindIp</code>）</li><li>创建相应的管理员账户</li><li>强制要求密码登录</li><li>养成定时备份的习惯</li></ul><h3 id="创建相应的管理员账户"><a href="#创建相应的管理员账户" class="headerlink" title="创建相应的管理员账户"></a>创建相应的管理员账户</h3><p>MongoDB中拥有不同权限的账号，具体可以查看：<a href="https://docs.mongodb.com/manual/reference/built-in-roles/" target="_blank" rel="noopener">【官方文档】</a><br>其中常用的如下：</p><ul><li>数据库普通用户角色<ul><li>read</li><li>readWrite</li></ul></li><li>数据库管理员角色<ul><li>dbAdmin</li><li>dbOwner</li><li>userAdmin</li></ul></li><li>集群管理角色<ul><li>clusterAdmin</li><li>clusterManager</li><li>clusterMonitor</li><li>hostManager</li></ul></li><li>备份与还原角色<ul><li>backup</li><li>restore</li></ul></li><li>所有数据库角色（对所有数据库有效）<ul><li>readAnyDatabase</li><li>readWriteAnyDatabase</li><li>userAdminAnyDatabase</li><li>dbAdminAnyDatabase</li></ul></li><li>超级角色<ul><li>root</li></ul></li><li>内部角色<ul><li>__system</li></ul></li></ul><p>roles是分配用户角色的地方，主要有<br>Read：允许用户读取指定数据库<br>readWrite：允许用户读写指定数据库<br>dbAdmin：允许用户在指定数据库中执行管理函数，如索引创建、删除，查看统计或访问system.profile<br>userAdmin：允许用户向system.users集合写入，可以找指定数据库里创建、删除和管理用户<br>clusterAdmin：只在admin数据库中可用，赋予用户所有分片和复制集相关函数的管理权限。<br>readAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的读权限<br>readWriteAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的读写权限<br>userAdminAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的userAdmin权限<br>dbAdminAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的dbAdmin权限。<br>root：只在admin数据库中可用。超级账号，超级权限</p><p>在你创建role的时候通过 <code>role: &quot;userAdminAnyDatabase&quot;</code> 来指定<br>这里以创建<code>userAdminAnyDatabase</code>为例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&gt; use admin</span><br><span class="line">switched to db admin</span><br><span class="line">&gt; db.createUser(</span><br><span class="line">... &#123;</span><br><span class="line">...   user: &quot;your name&quot;,</span><br><span class="line">...   pwd: &quot;your password&quot;,</span><br><span class="line">...   roles: [ &#123; role: &quot;userAdminAnyDatabase&quot;, db: &quot;admin&quot; &#125; ]</span><br><span class="line">... &#125;</span><br><span class="line">... )</span><br><span class="line">Successfully added user: &#123;</span><br><span class="line">        &quot;user&quot; : &quot;*****&quot;,</span><br><span class="line">        &quot;roles&quot; : [</span><br><span class="line">                &#123;</span><br><span class="line">                        &quot;role&quot; : &quot;userAdminAnyDatabase&quot;,</span><br><span class="line">                        &quot;db&quot; : &quot;admin&quot;</span><br><span class="line">                &#125;</span><br><span class="line">        ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>创建成功后可以通过以下命令查看所有用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; use admin</span><br><span class="line">switched to db admin</span><br><span class="line">&gt; db.system.users.find()</span><br></pre></td></tr></table></figure><p>另外，删除某个用户则为：<code>&gt; db.system.users.remove({user:&quot;xxx&quot;})</code></p><h3 id="强制要求密码登录"><a href="#强制要求密码登录" class="headerlink" title="强制要求密码登录"></a>强制要求密码登录</h3><p>vim 编辑 <code>/etc/mongod.conf</code>，添加以下内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">security:</span><br><span class="line">  authorization: enabled</span><br></pre></td></tr></table></figure><p>保存后重启<code>mongod</code>，之后必须先通过 <code>db.auth(&#39;your name&#39;,&#39;your password&#39;)</code> 验证成功。</p><h3 id="下次新建数据库的时候"><a href="#下次新建数据库的时候" class="headerlink" title="下次新建数据库的时候"></a>下次新建数据库的时候</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&gt; use admin</span><br><span class="line">switched to db admin</span><br><span class="line">&gt; db.auth(&quot;xxx&quot;,&quot;xxx&quot;) # userAdminAnyDatabase 权限的用户</span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">&gt; use newdb</span><br><span class="line">switched to db newdb</span><br><span class="line">&gt; db.createUser(</span><br><span class="line">...   &#123;</span><br><span class="line">...     user: &quot;your name&quot;,</span><br><span class="line">...     pwd: &quot;your password&quot;,</span><br><span class="line">...     roles: [ &#123; role: &quot;readWrite&quot;, db: &quot;newdb&quot; &#125; ]</span><br><span class="line">...   &#125;</span><br><span class="line">... )</span><br><span class="line">Successfully added user: &#123;</span><br><span class="line">        &quot;user&quot; : &quot;***&quot;,</span><br><span class="line">        &quot;roles&quot; : [</span><br><span class="line">                &#123;</span><br><span class="line">                        &quot;role&quot; : &quot;readWrite&quot;,</span><br><span class="line">                        &quot;db&quot; : &quot;***&quot;</span><br><span class="line">                &#125;</span><br><span class="line">        ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;起因&quot;&gt;&lt;a href=&quot;#起因&quot; class=&quot;headerlink&quot; title=&quot;起因&quot;&gt;&lt;/a&gt;起因&lt;/h3&gt;&lt;p&gt;今天一看突然发现网站上的数据都没了，一看数据库，里面的表全没了，然后多了一张叫 &lt;code&gt;RECOVERY&lt;/code&gt; 的 &lt;code&gt;
      
    
    </summary>
    
    
      <category term="Software" scheme="https://eyum.top/categories/Software/"/>
    
    
      <category term="MongoDB" scheme="https://eyum.top/tags/MongoDB/"/>
    
  </entry>
  
  <entry>
    <title>Scrapy爬取的数据存入MongoDB</title>
    <link href="https://eyum.top/2020/02/23/Scrapy%E7%88%AC%E5%8F%96%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%85%A5MongoDB/"/>
    <id>https://eyum.top/2020/02/23/Scrapy爬取的数据存入MongoDB/</id>
    <published>2020-02-23T04:54:24.000Z</published>
    <updated>2020-07-08T09:40:26.345Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前期工作"><a href="#前期工作" class="headerlink" title="前期工作"></a>前期工作</h3><ul><li>Scrapy</li><li>pymongo</li><li>MongoDB</li></ul><h3 id="通过-pymongo-库连接-MongoDB"><a href="#通过-pymongo-库连接-MongoDB" class="headerlink" title="通过 pymongo 库连接 MongoDB"></a>通过 pymongo 库连接 MongoDB</h3><p>在这里，需要用到的是 pymongo 库里面的 MongoClient，向该方法传入 MongoDB 的 IP 及 端口。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">client = pymongo.MongoClient(<span class="string">'mongodb://your ip address:27017/'</span>)</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">client = pymongo.MongoClient(host=<span class="string">'your ip address'</span>, port=<span class="number">27017</span>)</span><br></pre></td></tr></table></figure><p>创建连接对象后，需要指定操作哪个数据库，这里为 pymongo 数据库。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db = client[<span class="string">"pymongo"</span>]</span><br></pre></td></tr></table></figure><p>由于我的 MongoDB 数据库启用了 auth 认证，没有的跳过。需要验证密码。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.authenticate(<span class="string">"***"</span>, <span class="string">"***"</span>)</span><br></pre></td></tr></table></figure><p>最后，声明了 Collection 对象，用于指定需要操作的集合。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">col = db[<span class="string">"test"</span>]</span><br></pre></td></tr></table></figure><p>可以往里面插入一条数据测试连接是否有效，使用 <code>insert_one()</code> 方法，该方法在执行后会返回一个 <code>_id</code> 值。<br>运行结果为：</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="Terminal.png" alt="Terminal.png" title>                </div>                <div class="image-caption">Terminal.png</div>            </figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="Navicat.png" alt="Navicat.png" title>                </div>                <div class="image-caption">Navicat.png</div>            </figure><p>完整代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line"></span><br><span class="line">client = pymongo.MongoClient(<span class="string">'mongodb://your ip address:27017/'</span>)</span><br><span class="line">db = client[<span class="string">"pymongo"</span>]</span><br><span class="line">db.authenticate(<span class="string">"***"</span>, <span class="string">"***"</span>)</span><br><span class="line">col = db[<span class="string">"test"</span>]</span><br><span class="line"></span><br><span class="line">dict = &#123;<span class="string">"id"</span>: <span class="string">"1"</span>, <span class="string">"name"</span>: <span class="string">"test"</span>&#125;</span><br><span class="line"></span><br><span class="line">x = col.insert_one(dict)</span><br><span class="line">print(x)</span><br></pre></td></tr></table></figure><h3 id="在-Scrapy-中使用"><a href="#在-Scrapy-中使用" class="headerlink" title="在 Scrapy 中使用"></a>在 Scrapy 中使用</h3><p>在 Scrapy 中的数据处理部分是写在 pipelines 文件内的，与上面步骤相同，那么直接贴完整代码吧：</p><figure class="highlight python"><figcaption><span>pipelines.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line"><span class="keyword">from</span> .settings <span class="keyword">import</span> mongo_host, mongo_port, mongo_db_name, mongo_db_collection</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NeteasePipeline</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        host = mongo_host</span><br><span class="line">        port = mongo_port</span><br><span class="line">        dbname = mongo_db_name</span><br><span class="line">        cname = mongo_db_collection</span><br><span class="line">        client = pymongo.MongoClient(host=host, port=port)</span><br><span class="line">        db = client[dbname]</span><br><span class="line">        self.post = db[cname]</span><br><span class="line">        db.authenticate(<span class="string">"***"</span>, <span class="string">"***"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">process_item</span><span class="params">(self, item, spider)</span>:</span></span><br><span class="line">        data = dict(item)</span><br><span class="line">        self.post.insert(data)</span><br><span class="line">        <span class="keyword">return</span> item</span><br></pre></td></tr></table></figure><p>其中，配置的部分我写在了 settings.py 中</p><figure class="highlight python"><figcaption><span>settings.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mongo_host = <span class="string">"your ip address"</span></span><br><span class="line">mongo_port = <span class="number">27017</span></span><br><span class="line">mongo_db_name = <span class="string">"***"</span></span><br><span class="line"><span class="comment"># 日期作为collection名字</span></span><br><span class="line">date = str(datetime.date.today())</span><br><span class="line">mongo_db_collection = date</span><br></pre></td></tr></table></figure><p>最后，在 settings.py 中进行相应的设置，数值越小优先级越高。</p><figure class="highlight python"><figcaption><span>settings.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Configure item pipelines</span></span><br><span class="line"><span class="comment"># See https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span></span><br><span class="line">ITEM_PIPELINES = &#123;</span><br><span class="line">   <span class="string">'netease.pipelines.NeteasePipeline'</span>: <span class="number">300</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;前期工作&quot;&gt;&lt;a href=&quot;#前期工作&quot; class=&quot;headerlink&quot; title=&quot;前期工作&quot;&gt;&lt;/a&gt;前期工作&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Scrapy&lt;/li&gt;
&lt;li&gt;pymongo&lt;/li&gt;
&lt;li&gt;MongoDB&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 
      
    
    </summary>
    
    
      <category term="Software" scheme="https://eyum.top/categories/Software/"/>
    
    
      <category term="MongoDB" scheme="https://eyum.top/tags/MongoDB/"/>
    
      <category term="Scrapy" scheme="https://eyum.top/tags/Scrapy/"/>
    
  </entry>
  
  <entry>
    <title>MongoDB</title>
    <link href="https://eyum.top/2020/02/21/MongoDB/"/>
    <id>https://eyum.top/2020/02/21/MongoDB/</id>
    <published>2020-02-21T07:25:28.000Z</published>
    <updated>2020-02-26T14:51:02.360Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>需求：将scrapy爬取的数据存入MongoDB，整理一下常用的命令，参考<a href="https://www.runoob.com/mongodb/mongodb-tutorial.html" target="_blank" rel="noopener">菜鸟教程</a>。</p></blockquote><h3 id="MongoDB简介"><a href="#MongoDB简介" class="headerlink" title="MongoDB简介"></a>MongoDB简介</h3><p>MongoDB 是由C++语言编写的，是一个基于分布式文件存储的开源数据库系统。<br>在高负载的情况下，添加更多的节点，可以保证服务器性能。<br>MongoDB 旨在为WEB应用提供可扩展的高性能数据存储解决方案。<br>MongoDB 将数据存储为一个文档，数据结构由键值(key=&gt;value)对组成。MongoDB 文档类似于 JSON 对象。字段值可以包含其他文档，数组及文档数组。</p><h3 id="增（有空写-￣▽￣”-）"><a href="#增（有空写-￣▽￣”-）" class="headerlink" title="增（有空写(￣▽￣”)）"></a>增（有空写(￣▽￣”)）</h3><h3 id="删"><a href="#删" class="headerlink" title="删"></a>删</h3><h3 id="改"><a href="#改" class="headerlink" title="改"></a>改</h3><h3 id="查"><a href="#查" class="headerlink" title="查"></a>查</h3>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;需求：将scrapy爬取的数据存入MongoDB，整理一下常用的命令，参考&lt;a href=&quot;https://www.runoob.com/mongodb/mongodb-tutorial.html&quot; target=&quot;_blank&quot; rel=&quot;noo
      
    
    </summary>
    
    
      <category term="Software" scheme="https://eyum.top/categories/Software/"/>
    
    
      <category term="MongoDB" scheme="https://eyum.top/tags/MongoDB/"/>
    
  </entry>
  
  <entry>
    <title>ftp主动被动模式详解</title>
    <link href="https://eyum.top/2020/01/28/ftp%E4%B8%BB%E5%8A%A8%E8%A2%AB%E5%8A%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3/"/>
    <id>https://eyum.top/2020/01/28/ftp主动被动模式详解/</id>
    <published>2020-01-28T13:20:33.000Z</published>
    <updated>2020-01-31T13:03:23.946Z</updated>
    
    <content type="html"><![CDATA[<h3 id="主动模式"><a href="#主动模式" class="headerlink" title="主动模式"></a>主动模式</h3><p>FTP 的传输使用的是 TCP 封包协议，FTP 的传输使用的是 TCP 封包协议。 FTP 服务器使用了两个联机，分别是命令信道与数据流通道 (ftp-data) ，这两个联机都需要经过三向交握。<figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="connect_active.gif" alt="主动模式" title>                </div>                <div class="image-caption">主动模式</div>            </figure><br>简单的联机流程就如上图所示，至于联机的步骤是这样的：</p><ol><li><p>建立命令通道的联机 如上图所示，客户端会随机取一个大于 1024 以上的端口 (port AA) 来与 FTP 服务器端的 port 21 达成联机， 这个过程当然需要三向交握了！达成联机后客户端便可以透过这个联机来对 FTP 服务器下达指令， 包括查询档名、下载、上传等等指令都是利用这个通道来下达的；</p></li><li><p>通知 FTP 服务器端使用 active 且告知连接的埠号 FTP 服务器的 21 埠号主要用在命令的下达，但是当牵涉到数据流时，就不是使用这个联机了。 客户端在需要数据的情况下，会告知服务器端要用什么方式来联机，如果是主动式 (active) 联机时， 客户端会先随机启用一个端口 (图 21.1-1 当中的 port BB) ，且透过命令通道告知 FTP 服务器这两个信息，并等待 FTP 服务器的联机；</p></li><li><p>FTP 服务器『主动』向客户端联机 FTP 服务器由命令通道了解客户端的需求后，会主动的由 20 这个埠号向客户端的 port BB 联机， 这个联机当然也会经过三向交握啦！此时 FTP 的客户端与服务器端共会建立两条联机，分别用在命令的下达与数据的传递。 而预设 FTP 服务器端使用的主动联机埠号就是 port 20 。</p></li></ol><p>如此一来则成功的建立起『命令』与『数据传输』两个信道。<br>同时 FTP 服务器端会使用到的端口号主要有以下两个：</p><ul><li>命令通道的 ftp (默认为 port 21) 与</li><li>数据传输的 ftp-data (默认为port 20)</li></ul><p>另外，很多的局域网络都会使用防火墙 (iptables) 的 NAT 功能，那么上图将变为如下所示：<figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="connect_active_nat.gif" alt="主动模式_NAT" title>                </div>                <div class="image-caption">主动模式_NAT</div>            </figure><br>其联机的步骤是这样的：</p><ol><li><p>用户与服务器间命令信道的建立： 因为 NAT 会主动的记录由内部送往外部的联机信息，而由于命令信道的建立是由客户端向服务器端联机的， 因此这一条联机可以顺利的建立起来的；</p></li><li><p>用户与服务器间数据信道建立时的通知： 同样的，客户端主机会先启用 port BB ，并透过命令通道告知 FTP 服务器，且等待服务器端的主动联机；</p></li><li><p>服务器主动连到 NAT 等待转递至客户端的联机问题： 但是由于透过 NAT 的转换后，FTP 服务器只能得知 NAT 的 IP 而不是客户端的 IP ， 因此 FTP 服务器会以 port 20 主动的向 NAT 的 port BB 发送主动联机的要求。 但你的 NAT 并没有启动 port BB 来监听 FTP 服务器的联机。</p></li></ol><p>由此可见，在 FTP 的主动式联机当中，NAT 将会被视为客户端，但 NAT 其实并非客户端， 这就造成问题了。如果你曾经在 IP 分享器后面连接某些 FTP 服务器时，可能偶尔会发现明明就连接上 FTP 服务器了 (命令通道已建立)，但是就是无法取得文件名的列表，而是在超过一段时间后显示『 Can’t build data connection: Connection refused，无法进行数据传输』之类的讯息， 那肯定就是这个原因所造成的困扰了。</p><p>那有没有办法可以克服这个问题呢？难道真的在 Linux NAT 后面就一定无法使用 FTP 吗？当然不是！ 目前有两个简易的方法可以克服这个问题：</p><ul><li><p>使用 iptables 所提供的 FTP 侦测模块：</p><p>其实 iptables 早就提供了许多好用的模块了，这个 FTP 当然不会被错过！ 你可以使用 modprobe 这个指令来加载 ipconntrack_ftp 及 ip_nat_ftp 等模块，这几个模块会主动的分析『目标是 port 21 的联机』信息， 所以可以得到 port BB 的资料，此时若接受到 FTP 服务器的主动联机，就能够将该封包导向正确的后端主机了！ ^^</p><p>不过，如果你链接的目标 FTP 服务器他的命令通道默认端口号并非标准的 21 埠号时 (例如某些地下 FTP 服务器)， 那么这两个模块就无法顺利解析出来了，这样说，理解吗？</p></li><li><p>客户端选择被动式 (Passive) 联机模式：</p><p>除了主动式联机之外，FTP 还提供一种称为被动式联机的模式，什么是被动式呢？ 既然主动式是由服务器向客户端联机，反过来讲，被动式就是由客户端向服务器端发起联机的啰！ 既然是由客户端发起联机的，那自然就不需要考虑来自 port 20 的联机啦！关于被动式联机模式将在以下介绍。</p></li></ul><h3 id="被动模式"><a href="#被动模式" class="headerlink" title="被动模式"></a>被动模式</h3><p>同样，我们可以使用底下的图示来作个简略的介绍：<figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="connect_passive.gif" alt="被动模式" title>                </div>                <div class="image-caption">被动模式</div>            </figure></p><p>其数据流联机流程如下：</p><ol><li><p>用户与服务器建立命令信道： 同样的需要建立命令通道，透过三向交握就可以建立起这个通道了。</p></li><li><p>客户端发出 PASV 的联机要求： 当有使用数据信道的指令时，客户端可透过命令通道发出 PASV 的被动式联机要求 (Passive 的缩写)， 并等待服务器的回应；</p></li><li><p>FTP 服务器启动数据端口，并通知客户端联机： 如果你的 FTP 服务器是能够处理被动式联机的，此时 FTP 服务器会先启动一个端口在监听。 这个端口号码可能是随机的，也可以自定义某一范围的端口，端看你的 FTP 服务器软件而定。 然后你的 FTP 服务器会透过命令通道告知客户端该已经启动的端口 (图中的 port PASV)， 并等待客户端的联机。</p></li><li><p>客户端随机取用大于 1024 的端口号进行连接： 然后你的客户端会随机取用一个大于 1024 的端口号来对主机的 port PASV 联机。 如果一切都顺利的话，那么你的 FTP 数据就可以透过 port BB 及 port PASV 来传送了。</p></li></ol><blockquote><p>PS: 本文来源于鸟哥的Linux私房菜</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;主动模式&quot;&gt;&lt;a href=&quot;#主动模式&quot; class=&quot;headerlink&quot; title=&quot;主动模式&quot;&gt;&lt;/a&gt;主动模式&lt;/h3&gt;&lt;p&gt;FTP 的传输使用的是 TCP 封包协议，FTP 的传输使用的是 TCP 封包协议。 FTP 服务器使用了两个联机，分别是命
      
    
    </summary>
    
    
      <category term="Software" scheme="https://eyum.top/categories/Software/"/>
    
    
      <category term="ftp" scheme="https://eyum.top/tags/ftp/"/>
    
  </entry>
  
  <entry>
    <title>ftp nologin用户</title>
    <link href="https://eyum.top/2020/01/28/ftp-nologin%E7%94%A8%E6%88%B7/"/>
    <id>https://eyum.top/2020/01/28/ftp-nologin用户/</id>
    <published>2020-01-28T13:11:03.000Z</published>
    <updated>2020-01-28T14:38:00.880Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ftp-nologin用户"><a href="#ftp-nologin用户" class="headerlink" title="ftp nologin用户"></a>ftp nologin用户</h3><blockquote><p>环境为：vsftpd: version 3.0.2</p></blockquote><p>最近需要捣鼓下FTP服务器，发现如果系统用户的登录shell设置为<code>/sbin/nologin</code>，就无法使用FTP服务,报错如下：<figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="ftp.png" alt="ftp.png" title>                </div>                <div class="image-caption">ftp.png</div>            </figure><br>原因是，ftp会根据<code>/etc/shells</code>这个文件来判断一个用户是否是有效用户，并阻止那些shell不在<code>/etc/shells</code>里的用户登陆。<br>所以如果ftp用户的登录shell为<code>/sbin/nologin</code>,则需要添加到<code>/etc/shells</code>文件里面，或者可以通过禁用<code>PAM模块</code>，注释<code>/etc/pam.d/vsftpd</code>文件内的<code>auth       required     pam_shells.so</code><img src="pam.png" alt="pam.png"></p><p>另外，出于安全的考虑，root用户是不能登录ftp的，如果有这个需求的话，可以将<code>/etc/vsftpd/ftpusers</code>文件内的<code>root</code>注释</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;ftp-nologin用户&quot;&gt;&lt;a href=&quot;#ftp-nologin用户&quot; class=&quot;headerlink&quot; title=&quot;ftp nologin用户&quot;&gt;&lt;/a&gt;ftp nologin用户&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;环境为：vsftpd: v
      
    
    </summary>
    
    
      <category term="Software" scheme="https://eyum.top/categories/Software/"/>
    
    
      <category term="ftp" scheme="https://eyum.top/tags/ftp/"/>
    
  </entry>
  
  <entry>
    <title>常用数学符号</title>
    <link href="https://eyum.top/2020/01/03/%E5%B8%B8%E7%94%A8%E6%95%B0%E5%AD%A6%E7%AC%A6%E5%8F%B7/"/>
    <id>https://eyum.top/2020/01/03/常用数学符号/</id>
    <published>2020-01-03T14:08:22.000Z</published>
    <updated>2020-01-03T15:57:16.985Z</updated>
    
    <content type="html"><![CDATA[<h3 id="符号"><a href="#符号" class="headerlink" title="符号"></a>符号</h3><blockquote><p>收录一些常用的数学符号的LaTeX，方便日常使用（持续更新……）</p></blockquote><h4 id="希腊字母"><a href="#希腊字母" class="headerlink" title="希腊字母"></a>希腊字母</h4><table><thead><tr><th align="center">希腊字母小写、大写</th><th align="center">LaTeX</th><th align="center">希腊字母小写、大写</th><th align="center">LaTeX</th></tr></thead><tbody><tr><td align="center">$\alpha\ A$</td><td align="center">\alpha A</td><td align="center">$\nu\ N$</td><td align="center">\nu N</td></tr><tr><td align="center">$\beta\ B$</td><td align="center">\beta B</td><td align="center">$\xi\ \Xi$</td><td align="center">\xi \Xi</td></tr><tr><td align="center">$\gamma\ \Gamma$</td><td align="center">\gamma \Gamma</td><td align="center">$\omicron\ O$</td><td align="center">\omicron O</td></tr><tr><td align="center">$\delta\ \Delta$</td><td align="center">\delta \Delta</td><td align="center">$\pi\ \Pi$</td><td align="center">\pi \Pi</td></tr><tr><td align="center">$\epsilon\ \varepsilon\ E    $</td><td align="center">\epsilon \varepsilon E</td><td align="center">$\rho\ \varrho\ P$</td><td align="center">\rho \varrho P</td></tr><tr><td align="center">$\zeta\ Z$</td><td align="center">\zeta Z</td><td align="center">$\sigma\ \Sigma$</td><td align="center">\sigma \Sigma</td></tr><tr><td align="center">$\eta\ H    $</td><td align="center">\eta H</td><td align="center">$\tau\ T$</td><td align="center">\tau T</td></tr><tr><td align="center">$\theta\ \vartheta\ \Theta$</td><td align="center">\theta \vartheta \Theta</td><td align="center">$\upsilon\ \Upsilon$</td><td align="center">\upsilon \Upsilon</td></tr><tr><td align="center">$\iota\ I    $</td><td align="center">\iota I</td><td align="center">$\phi\ \varphi\ \Phi$</td><td align="center">\phi \varphi \Phi</td></tr><tr><td align="center">$\kappa\ K$</td><td align="center">\kappa K</td><td align="center">$\chi\ x\ X$</td><td align="center">\chi x X</td></tr><tr><td align="center">$\lambda\ \Lambda$</td><td align="center">\lambda \Lambda</td><td align="center">$\psi\ \Psi$</td><td align="center">\psi \Psi</td></tr><tr><td align="center">$\mu\ M    $</td><td align="center">\mu M</td><td align="center">$\omega\ \Omega$</td><td align="center">\omega \Omega</td></tr></tbody></table><ul><li>注：\mit\Gamma 表斜体 $\mit\Gamma$</li></ul><h4 id="数和数组"><a href="#数和数组" class="headerlink" title="数和数组"></a>数和数组</h4><table><thead><tr><th align="center">符号</th><th align="center">LaTeX</th><th align="center">概念</th><th align="center">符号</th><th align="center">LaTeX</th><th align="center">概念</th></tr></thead><tbody><tr><td align="center">$a$</td><td align="center">a</td><td align="center">标量（整数或实数）</td><td align="center">$e^{(i)}$</td><td align="center">e^{(i)}</td><td align="center">标准基向量[0,…,0,1,0,…,0]，其中索引 $i$ 处值为1</td></tr><tr><td align="center">$\boldsymbol{a}$</td><td align="center">\boldsymbol{a}</td><td align="center">向量</td><td align="center">${\rm diag}(a)$</td><td align="center">{\rm diag}(a)</td><td align="center">对角方阵，其中对角元素由 $a$ 给定</td></tr><tr><td align="center">$A$</td><td align="center">A</td><td align="center">矩阵</td><td align="center">$\rm{a}$</td><td align="center">\rm{a}</td><td align="center">标量随机变量</td></tr><tr><td align="center">$\rm{\textbf{A}}$</td><td align="center">\rm{\textbf{A}}</td><td align="center">张量</td><td align="center">$\textbf{a}$</td><td align="center">\textbf{a}</td><td align="center">向量随机变量</td></tr><tr><td align="center">$I_n$</td><td align="center">I_n</td><td align="center">$n$ 行 $n$ 列的单位矩阵</td><td align="center">$\rm{A}$</td><td align="center">\rm{A}</td><td align="center">矩阵随机变量</td></tr><tr><td align="center">$I$</td><td align="center">I</td><td align="center">维度蕴含于上下文的单位矩阵</td><td align="center"></td><td align="center"></td><td align="center"></td></tr></tbody></table><h4 id="代数"><a href="#代数" class="headerlink" title="代数"></a>代数</h4>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;符号&quot;&gt;&lt;a href=&quot;#符号&quot; class=&quot;headerlink&quot; title=&quot;符号&quot;&gt;&lt;/a&gt;符号&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;收录一些常用的数学符号的LaTeX，方便日常使用（持续更新……）&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id
      
    
    </summary>
    
    
      <category term="Paper" scheme="https://eyum.top/categories/Paper/"/>
    
    
      <category term="LaTeX" scheme="https://eyum.top/tags/LaTeX/"/>
    
  </entry>
  
  <entry>
    <title>机器学习中的数学</title>
    <link href="https://eyum.top/2020/01/03/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%A6/"/>
    <id>https://eyum.top/2020/01/03/机器学习中的数学/</id>
    <published>2020-01-03T04:56:23.000Z</published>
    <updated>2020-07-08T09:16:32.011Z</updated>
    
    <content type="html"><![CDATA[<h3 id="机器学习中的数学"><a href="#机器学习中的数学" class="headerlink" title="机器学习中的数学"></a>机器学习中的数学</h3><ul><li>平方误差</li><li>梯度下降法</li><li>矩阵求解</li><li>极大似然估计</li><li>熵的原理</li><li>启发式算法</li></ul><h4 id="平方误差"><a href="#平方误差" class="headerlink" title="平方误差"></a>平方误差</h4><p>误差，指的是某个变量的错误程度，直白来说，误差就是“真实值-预测值”。那么，平方误差通过计算每一个样本误差的平方，再求和。即平方误差的公式是 $L=\sum_{i=1}^{N}(\hat{y}_{i}-y_{i})^{2}$。其中，$\hat{y}_{i}$ 为第 $i$ 个样本的真实值，$y_{i}$ 为第 $i$ 个样本的预测值。</p><h4 id="梯度下降法"><a href="#梯度下降法" class="headerlink" title="梯度下降法"></a>梯度下降法</h4><p>机器学习中的所有算法都依赖于最小化或最大化某一个函数，我们称之为“目标函数”。最小化的这组函数被称为“损失函数”。损失函数是衡量预测模型预测期望结果表现的指标。寻找函数最小值的最常用方法是“梯度下降”。把损失函数想象成起伏的山脉，梯度下降就像从山顶滑下，目的是到达山脉的最低点。<br>关于求解极小值问题，我们常用的方法是代数法和求导法：</p><ul><li>代数法：$y=x^{2}+2x+3$ 可以化为 $y=(x+1)^{2}+2$，那么其最小值 $x$ = -1时取到。</li><li>求导法：令 $y=x^{2}+2x+3$ 的导数：$\frac{\mathrm{d}y}{\mathrm{d}x}=2x+2=0$。解得 $x$ = -1时 $y$ 取得最小值。</li></ul><p>但是，求解函数$y=x^{2}+2x+e^{x}+3$的极小值时，代数法和求导法都不再适用，此时就需要用更通用的极值求解方法，这就是梯度下降法。<br>首先，梯度 (gradient) 是一阶偏导组成的向量，其表示函数变化率最快的方向，是相对于一个向量求导的导数： $f$ 的梯度是包含所有偏导数的向量，记为 ${\nabla}_{x}f(x)$。梯度的第 $i$ 个元素是 $f$ 关于 $x_i$ 的偏导数。在多维情况下，临界点是梯度中的所有元素都为 $0$ 的点。<br>在 $u$(单位向量)方向的方向导数 (directional derivative) 是函数 $f$ 在 $u$ 方向的斜率。换句话说，方向导数是函数 $f(x+{\alpha}u)$ 关于 $\alpha$ 的导数（在 $\alpha$ = 0 时取到）。使用链式法则，我们可以看到当 $\alpha$ = 0 时，$\frac{\partial}{\partial \alpha}f(x+{\alpha}u)=u^\top{\nabla}_{x}f(x)$。<br>为了最小化 $f$,我们希望找到使 $f$ 下降得最快的方向。计算方向导数为：$$\min_{u,u^\top u=1}u^\top{\nabla}_{x}f(x)$$$$=\min_{u,u^\top u=1}\left|\left|u\right|\right|_2 \left|\left|{\nabla}_{x}f(x)\right|\right|_2 \cos \theta$$<br>其中 $\theta$ 是 $u$ 与梯度的夹角。将 $ \left|\left|u\right|\right|_2 =1$ 带入，并忽略与 $u$ 无关的项，就能简化得到 $\min_u \cos \theta$。这在 $u$ 与梯度方向相反时取得最小。换句话说，梯度向量指向上坡，负梯度向量指向下坡。我们在负梯度方向上移动可以减小 $f$。这就是梯度下降法(gradient descent)，也称最速下降法(method of steepest descent)。<br>最速下降法建议新的点为$$x’=x-\epsilon{\nabla}_{x}f(x)$$<br>其中 $\epsilon$ 为学习率(learning rate)，是一个确定步长大小的正标量。我们可以通过几种不同的方式选择 $\epsilon$。普遍的方式是选择一个小常数。有时我们通过计算，选择使方向导数消失的步长。还有一种方法是根据几个 $\epsilon$ 计算 $f(x-\epsilon{\nabla}_{x}f(x))$,并选择其中能产生最小目标函数值的 $\epsilon$。这种策略是线搜索。<br>回到上面的题，求 $y=x^{2}+2x+e^{x}+3$ 的最小值。首先我们先随机初始化一个点 $x_0=0$ ，设置学习率 $\epsilon=0.3$,其次，计算梯度 ${\nabla}_{x}f(x)=\frac{\mathrm{d}y}{\mathrm{d}x}=2x+2+e^x$。之后的计算交给MATLAB，代码如下：</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">0.0</span>;  <span class="comment">%初始化值</span></span><br><span class="line">c = <span class="number">0.5</span>;  <span class="comment">%设置学习率</span></span><br><span class="line"></span><br><span class="line">fprintf(<span class="string">'n\t\t更新前的点\t\t梯度\t\t更新后的点\n'</span>);</span><br><span class="line"><span class="keyword">for</span> n = <span class="number">1</span> : <span class="number">10</span></span><br><span class="line">xold = x;                 <span class="comment">%本次循环前的 xt 值</span></span><br><span class="line">grad = <span class="number">2</span>*x+<span class="number">2</span>+<span class="built_in">exp</span>(x);   <span class="comment">%梯度</span></span><br><span class="line">xnew = x - c*grad;    <span class="comment">%梯度下降法更新后的点</span></span><br><span class="line"></span><br><span class="line">fprintf(<span class="string">'%d\t\t%6.2f\t\t%6.2f\t\t%6.2f\n'</span>,n,xold,grad,xnew);</span><br><span class="line"></span><br><span class="line">x = xnew;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>得到结果如下：</p><table><thead><tr><th align="center">n</th><th align="center">更新前的点</th><th align="center">梯度</th><th align="center">更新后的点</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">0.00</td><td align="center">3.00</td><td align="center">-1.50</td></tr><tr><td align="center">2</td><td align="center">-1.50</td><td align="center">-0.78</td><td align="center">-1.11</td></tr><tr><td align="center">3</td><td align="center">-1.11</td><td align="center">-0.11</td><td align="center">-1.16</td></tr><tr><td align="center">4</td><td align="center">-1.16</td><td align="center">-0.02</td><td align="center">-1.16</td></tr><tr><td align="center">5</td><td align="center">-1.16</td><td align="center">-0.00</td><td align="center">-1.16</td></tr><tr><td align="center">6</td><td align="center">-1.16</td><td align="center">-0.00</td><td align="center">-1.16</td></tr><tr><td align="center">7</td><td align="center">-1.16</td><td align="center">-0.00</td><td align="center">-1.16</td></tr><tr><td align="center">8</td><td align="center">-1.16</td><td align="center">-0.00</td><td align="center">-1.16</td></tr><tr><td align="center">9</td><td align="center">-1.16</td><td align="center">-0.00</td><td align="center">-1.16</td></tr><tr><td align="center">10</td><td align="center">-1.16</td><td align="center">-0.00</td><td align="center">-1.16</td></tr></tbody></table><p>从上表中可以看到，在第4次循环后，$x’$ 的值不再改变，收敛于 $x=-1.16$，即，当 $x=-1.16$ 时，y取得最小值为 $y_{min}=(-1.16)^2+2*(-1.16)+e^{-1.16}+3=2.33908$</p><h4 id="矩阵求解-待更新"><a href="#矩阵求解-待更新" class="headerlink" title="矩阵求解(待更新)"></a>矩阵求解(待更新)</h4><h4 id="极大似然估计"><a href="#极大似然估计" class="headerlink" title="极大似然估计"></a>极大似然估计</h4><h4 id="熵的原理"><a href="#熵的原理" class="headerlink" title="熵的原理"></a>熵的原理</h4><h4 id="启发式算法"><a href="#启发式算法" class="headerlink" title="启发式算法"></a>启发式算法</h4>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;机器学习中的数学&quot;&gt;&lt;a href=&quot;#机器学习中的数学&quot; class=&quot;headerlink&quot; title=&quot;机器学习中的数学&quot;&gt;&lt;/a&gt;机器学习中的数学&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;平方误差&lt;/li&gt;
&lt;li&gt;梯度下降法&lt;/li&gt;
&lt;li&gt;矩阵求解&lt;/li&gt;
&lt;
      
    
    </summary>
    
    
      <category term="Algorithm" scheme="https://eyum.top/categories/Algorithm/"/>
    
    
      <category term="Machine learning" scheme="https://eyum.top/tags/Machine-learning/"/>
    
      <category term="Math" scheme="https://eyum.top/tags/Math/"/>
    
      <category term="Deep learning" scheme="https://eyum.top/tags/Deep-learning/"/>
    
  </entry>
  
  <entry>
    <title>electron-ssr</title>
    <link href="https://eyum.top/2019/10/21/electron-ssr/"/>
    <id>https://eyum.top/2019/10/21/electron-ssr/</id>
    <published>2019-10-21T14:50:22.000Z</published>
    <updated>2020-01-10T03:17:11.844Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容."><div class="hbe-input-container"><input type="password" id="hbePass" placeholder="您好, 这里需要密码." /><label>您好, 这里需要密码.</label><div class="bottom-line"></div></div><script id="hbeData" type="hbeData" data-hmacdigest="9d89a6658198f8f2433f943bd689f6eea085da2d75ac04259ca6fab7f11a9acb">c04295c43d6c86e1e9439416c61930bea34b6620ead3aa48531cae152bca15dac2d4ff6d29f243443e4517374c7306ede6882f744535d4f228bc3c609272b72fa00c89f85a12788870b5a289d202c09744aedd9b0be2e8d58185f0035346398e3351ba5fa2ba4891e89a6e3893164b8cbf9eae6d4e2e0c59ee4c4c1f7791e22de444428d9902473bdef6bb21b575138526f95ace02bde44d44f71dd9cf30c7e452ba78ba50d4e9fa92c5b2cdb5a213f72dab0a9b3ccaf3732e6257a751d4434fd60957e34f9c23dca1314c9fd4c0ed85a7701677345877b6bdd6b3d990fc95829471002e3f0cf753737cf88ddd04faff8ddd2a7056103592a05bc2e04b11534d4703489d1bf956ebcd4011857ddb8c65390985775518d8e14dd1713108ae483ea601f94554788e439dcab59e1a3d3a125be6a0000b6cae14a33414e51bd1169c5485a6f85c7d4680a33ad3552f0bbe21179c54619a07fc8995e751c95fccb3da23dae2df14dde64142239670d32f9124b4df89b5d4f3d6ab94dc831152af22e10bcc394f02e4ac2ad40b239c8eb97b4c9634bb404d82fadc4fb545958f6449d790fc1ea5aa2c57c22b39bc738d4577b5aba065ac53c7dc569896f25f3e13188a94522f3d5e0771ee2d7c875ac55e4fa06c7972bf5c1af2ddc96cb80c4dc235a64ccc29566f96a6349425f0bcac437be8ca29c2f91f882b0412d3364ce5bf58add41bc66624da76ec06b69744f997c58b54b0d209d453c887a8f8852fe8c66ca2b1fcea83ebf5234914cf363b2391cecbde422bf7280cdff9b5f0a4d287e7c80329cc5ad009a4e14f6b886f39af0eba7e7a8a74339c6f465e2f8345c666a405903686f85189aec8856a31b147ecec4e12324f0f4cd2010c8321a453520c06d2b2e204699f463ff1dc0955ac758735ca19342d18970273ccc1504fabcff7ba6e8d0acb198cc088099b5e60e00e194a88089caecf37aadc4039f29670df53a4a2fd35cd88896b04fc72998f747fa07a28f0e17ac2caf083856b23e2fdc65359a6429f71b4e8e398ef292689dad737f0ce282c378aaf6cc9fd6f135d4ff8ce0f7ebefefb1304f758e6bf344a5159ee28a4b93f4e08c3de94a0374a2bc18e3cdf14e21f6449247110d089e36d833b6a3ca58044beaaf51fd736289faba9ddf628fa28bf0cb02e7667140bedabb2603ea35a79200a303e49fafddea0983f59540e9eac28e4b614cdfa3ec5aff40571a588dd0de949c5e4118173c05106466ba87c06dc5d4d79abe3177cdf0fada90eb3f03c4d603cac76a17ae4ed604d1f7c15f08dad90931fadedddeff71944d7b74645a793cdd20fd6b75b84f1d2c55d033d27202fddf74823715eadd313dad2e07e3cac6d856927cd929d8414cd8034303230f1d910632ff4466e0214421f21ced7c0763b95a4415033d5963e44ff02c2b7e6984bf847a3bf98615ce2a8c1063346995da2102366df022a3ef5009045b3f0deb3af161c9b8a6311c1dbb5c93142caf07ea7223145e8334147c23e225aaed899d819ec86ceb4339a0bf8e0c186a625b158fc0185f82d644eac563da26a992e8954a254efcc2c4fd797f5da0693b583f36b1bd9c5541ce0d59cf6fe36e2210a6258b4bcd790f85bc7ab524a23f3bdbebc8769624c6a70518dfa4e8f2c3975559c04127bcd3e77c17d255ee803ecd34b85227ffad4ae4a592286c8b9dbc47ae01c51d90daca7b75ef6b87735f7b985661583e8ff56f26ca32e1cb179a010d53419449ce194b633564a0abe0aedee370e2470c94a4bdd24075496d38f1d3b9639e028e77122d1eb1e8bc4a18fe33917c67483675faa72fec81175eda63bd5a7e4ff96f2dd5cf58e32782f6a28257e8275db6c615260cf1d6fbbc634ff6316f6d39c23861fb307c6517d44c308903da65a3476c808faa60ef077e53ce47d33511a8eaa3356deaebee9b913779d1360f4f890da2acaae98cadaa4a03bdcb7bbb75aaf6e0c43c9c9ac86b3459e51ab9cf6da8a0b977c28ffe143a203d7f5926b1fdaa619b60e92d04e61e7d3648782040c09357c5c5df546e1ef9d4842fe2782a325d1321aecfa14c3b5edefc81496a744206013dfb3009eeff06c47d04e5b96d0f52170f8b88a215270810e729914846dd6720fe35757b57bcfc5775c240340b71ec779b8ba2e3e9b55b221c11275f0dc525e5e80038660a58de56eb1641b70dac5c85a94db7ec594268d403649c75deb32334f6042ab7649e1bf39b8db8828ce37fbdf1dbbd7396e0e042adaa65def8487fb375ab971f9d8b3ff12b213ff6ab4b2c3a72b93bc2489de62806ec633f718d8c7fce4ce7c21187126b3626c2edf0dbdf304aa5c2a7de4cdd05fcfc04a0ec12f4564679f06b4cb5b4dc75f8a06ae96689fcb4e5e796a0987ec85707bd7f642eefc739e7a3ac2f23ed84da603518ee1256d9cc21673e3ac688068adc488fedc97745619c610ce53bb2828b4790268a755514644abc7fd4cdca5159fbe84e8dcfca68c8ed919bc02eb640cb35d86579881d5e73fe8fc11c05a0616eaa6926f3f88003d9028dc84489ca82462510c18d987e0c5906a6f5620db9cbe4c86865d3236ec3704312f4bba4b7eda403b2b6997269cf4e32a9bafea86c1129979a597c0b2b28a193011c3277c6895982e7f30b65e6d977198174365c35e42a2d04479f8ed780eef</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      该文章已被加密.
    
    </summary>
    
    
    
      <category term="Linux" scheme="https://eyum.top/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Android-action</title>
    <link href="https://eyum.top/2019/10/16/Android-action/"/>
    <id>https://eyum.top/2019/10/16/Android-action/</id>
    <published>2019-10-16T14:40:39.000Z</published>
    <updated>2020-07-08T09:11:30.372Z</updated>
    
    <content type="html"><![CDATA[<h4 id="编写一个MainActivity和MyService，在MainActivity中的onCreate-函数中为两个按钮分别设置点击事件监听器，点击第一个按钮启动服务弹出一个Toast显示“您点击了第一个按钮”，点击第二个按钮启动服务弹出一个Toast显示“您点击了第二个按钮”。（以action区分不同的动作）"><a href="#编写一个MainActivity和MyService，在MainActivity中的onCreate-函数中为两个按钮分别设置点击事件监听器，点击第一个按钮启动服务弹出一个Toast显示“您点击了第一个按钮”，点击第二个按钮启动服务弹出一个Toast显示“您点击了第二个按钮”。（以action区分不同的动作）" class="headerlink" title="编写一个MainActivity和MyService，在MainActivity中的onCreate()函数中为两个按钮分别设置点击事件监听器，点击第一个按钮启动服务弹出一个Toast显示“您点击了第一个按钮”，点击第二个按钮启动服务弹出一个Toast显示“您点击了第二个按钮”。（以action区分不同的动作）"></a>编写一个MainActivity和MyService，在MainActivity中的onCreate()函数中为两个按钮分别设置点击事件监听器，点击第一个按钮启动服务弹出一个Toast显示“您点击了第一个按钮”，点击第二个按钮启动服务弹出一个Toast显示“您点击了第二个按钮”。（以action区分不同的动作）</h4><ul><li><p>MainActivity.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        <span class="keyword">final</span> Button button1 = findViewById(R.id.button1);</span><br><span class="line">        Button button2 = findViewById(R.id.button2);</span><br><span class="line">        button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                Intent intent = <span class="keyword">new</span> Intent(MainActivity.<span class="keyword">this</span>, MyService.class);</span><br><span class="line">                intent.setAction(<span class="string">"ACTION_BUTTON_1"</span>);</span><br><span class="line">                startService(intent);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button2.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                Intent intent = <span class="keyword">new</span> Intent(MainActivity.<span class="keyword">this</span>, MyService.class);</span><br><span class="line">                intent.setAction(<span class="string">"ACTION_BUTTON_2"</span>);</span><br><span class="line">                startService(intent);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>MyService.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyService</span> <span class="keyword">extends</span> <span class="title">Service</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBinder <span class="title">onBind</span><span class="params">(Intent intent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"Not yet implemented"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">onStartCommand</span><span class="params">(Intent intent, <span class="keyword">int</span> flags, <span class="keyword">int</span> startId)</span> </span>&#123;</span><br><span class="line">        String intentAction = intent.getAction();</span><br><span class="line">        <span class="keyword">if</span> (intentAction.equals(<span class="string">"ACTION_BUTTON_1"</span>)) &#123;</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>, <span class="string">"您点击了第一个按钮"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (intentAction.equals(<span class="string">"ACTION_BUTTON_2"</span>)) &#123;</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>, <span class="string">"您点击了第二个按钮"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onStartCommand(intent, flags, startId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;编写一个MainActivity和MyService，在MainActivity中的onCreate-函数中为两个按钮分别设置点击事件监听器，点击第一个按钮启动服务弹出一个Toast显示“您点击了第一个按钮”，点击第二个按钮启动服务弹出一个Toast显示“您点击了
      
    
    </summary>
    
    
    
      <category term="Android" scheme="https://eyum.top/tags/Android/"/>
    
  </entry>
  
</feed>
